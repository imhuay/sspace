## è®¾è®¡LFUç¼“å­˜ç»“æ„
<!--START_SECTION:badge-->
![last modify](https://img.shields.io/static/v1?label=last%20modify&message=2025-07-08%2016%3A53%3A13&label_color=gray&color=thistle&style=flat-square)
[![](https://img.shields.io/static/v1?label=&message=%E5%9B%B0%E9%9A%BE&label_color=gray&color=yellow&style=flat-square)](../../../README.md#å›°éš¾)
[![](https://img.shields.io/static/v1?label=&message=%E7%89%9B%E5%AE%A2&label_color=gray&color=green&style=flat-square)](../../../README.md#ç‰›å®¢)
[![](https://img.shields.io/static/v1?label=&message=%E8%AE%BE%E8%AE%A1&label_color=gray&color=blue&style=flat-square)](../../../README.md#è®¾è®¡)
[![](https://img.shields.io/static/v1?label=&message=%E7%BB%8F%E5%85%B8&label_color=gray&color=blue&style=flat-square)](../../../README.md#ç»å…¸)
<!--END_SECTION:badge-->
<!--info
tags: [è®¾è®¡, ç»å…¸]
source: ç‰›å®¢
level: å›°éš¾
number: '0094'
name: è®¾è®¡LFUç¼“å­˜ç»“æ„
companies: []
-->

> [è®¾è®¡LFUç¼“å­˜ç»“æ„_ç‰›å®¢é¢˜éœ¸_ç‰›å®¢ç½‘](https://www.nowcoder.com/practice/93aacb4a887b46d897b00823f30bfea1)

<summary><b>é—®é¢˜ç®€è¿°</b></summary>

```txt
è®¾è®¡LFU(æœ€è¿‘æœ€å°‘é¢‘æ¬¡ä½¿ç”¨)ç¼“å­˜ç»“æ„.
```

<!--
<details><summary><b>è¯¦ç»†æè¿°</b></summary>

```txt
```

</details>
-->


<!-- <div align="center"><img src="../../../_assets/xxx.png" height="300" /></div> -->

<summary><b>æ€è·¯</b></summary>

- å®šä¹‰ `key2cnt` ä¿å­˜ key çš„æ“ä½œé¢‘æ•°; `cnt2key` ä¿å­˜å„é¢‘æ•°çš„ key é˜Ÿåˆ—;
    - `cnt2key` ä¸­å¯ä»¥ä½¿ç”¨ dict (åªä½¿ç”¨ key) ä½œä¸ºæœ‰åº set ä»£æ›¿é˜Ÿåˆ—, æå‡åˆ é™¤æ•ˆç‡;
- å®šä¹‰ `refresh`, æ¯æ¬¡æ“ä½œåæ›´æ–° cnt é˜Ÿåˆ—;
- å®šä¹‰ `least` ä¿å­˜å½“å‰æœ€å°‘çš„é¢‘æ•°;
    - æ¯æ¬¡æœ‰æ–° key è¿›æ¥æ—¶, é‡ç½® `least` ä¸º 1;
    - æ¯æ¬¡æ›´æ–° cnt2key å, å¦‚æœå½“å‰çš„é˜Ÿåˆ—ä¸ºç©ºä¸”ç­‰äº `least`, éœ€è¦`least += 1`;

<details><summary><b>Python å†™æ³•1</b></summary>

```python
class Solution:
    from collections import defaultdict, deque
    k: int  # å®¹é‡
    least = 1  # è®°å½•å½“å‰æœ€å°‘é¢‘æ¬¡
    key2val = dict()
    key2cnt = defaultdict(int)  # è¿™ä¸ªå’Œ key2val å¯ä»¥åˆå¹¶åœ¨ä¸€èµ·å¯ä»¥çœä¸€ç»„ key, è¿™é‡Œä¸ºäº†æ›´æ¸…æ™°åˆ†å¼€å­˜å‚¨
    cnt2key = defaultdict(dict)  # è¿™é‡Œå®é™…åªç”¨åˆ°äº† dict çš„ key ä½œä¸ºæœ‰åº set

    def refresh(self, key):
        cnt = self.key2cnt[key]
        self.cnt2key[cnt].pop(key)
        if len(self.cnt2key[cnt]) == 0:
            self.cnt2key.pop(cnt)
            if self.least == cnt:
                self.least += 1
        self.key2cnt[key] += 1
        self.cnt2key[cnt + 1][key] = None  # å› ä¸ºåªç”¨äº† key,

    def get(self, key):
        ret = self.key2val.get(key, -1)
        if key in self.key2val:
            self.refresh(key)
        return ret

    def set(self, key, value):
        if key not in self.key2val:
            # è¶…å®¹é‡çš„æƒ…å†µ
            if len(self.key2val) >= self.k:
                tmp = next(iter(self.cnt2key[self.least]))
                # å…¨éƒ¨ pop
                self.cnt2key[self.least].pop(tmp)
                self.key2val.pop(tmp)
                self.key2cnt.pop(tmp)
            self.key2val[key] = value
            self.key2cnt[key] += 1
            self.cnt2key[self.key2cnt[key]][key] = None
            self.least = 1  # å› ä¸ºæ˜¯æ–°çš„ key, æ‰€ä»¥æ˜¾ç„¶æœ€å°‘é¢‘æ¬¡å°†æ›´æ–°ä¸º 1
        else:
            self.refresh(key)
            self.key2val[key] = value

    def LFU(self , operators: List[List[int]], k: int) -> List[int]:
        self.k = k

        ret = []
        for op in operators:
            if op[0] == 1:
                self.set(op[1], op[2])
            else:
                ret.append(self.get(op[1]))

        return ret
```

</details>

- å†™æ³• 2 çš„åŒºåˆ«ä»…åœ¨äºå°† `key2cnt` å’Œ `key2val` åˆå¹¶åœ¨ä¸€èµ·, çœäº†ä¸€ç»„ `key` çš„ç©ºé—´;

<details><summary><b>Python å†™æ³•2</b></summary>

```python
class Solution:
    from collections import defaultdict, deque
    k: int  # å®¹é‡
    least = 1  # è®°å½•å½“å‰æœ€å°‘é¢‘æ¬¡
    key2cnt = dict()  # å‡ºäº†ä¿å­˜é¢‘æ¬¡, ä¹Ÿä¿å­˜äº†å€¼
    cnt2key = defaultdict(dict)  # è¿™é‡Œå®é™…åªç”¨åˆ°äº† dict çš„ key ä½œä¸ºæœ‰åº set
    # è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨é˜Ÿåˆ—, ä½†æ˜¯åˆ é™¤æ•ˆç‡åº”è¯¥ä¸å¦‚ set

    def refresh(self, key):
        cnt = self.key2cnt[key][0]
        self.cnt2key[cnt].pop(key)
        if len(self.cnt2key[cnt]) == 0:
            self.cnt2key.pop(cnt)
            if self.least == cnt:
                self.least += 1
        self.key2cnt[key][0] += 1
        self.cnt2key[cnt + 1][key] = None  # å› ä¸ºåªç”¨äº† key,

    def get(self, key):
        ret = self.key2cnt[key][1] if key in self.key2cnt else -1
        if key in self.key2cnt:
            self.refresh(key)
        return ret

    def set(self, key, value):
        if key not in self.key2cnt:
            # è¶…å®¹é‡çš„æƒ…å†µ
            if len(self.key2cnt) >= self.k:
                tmp = next(iter(self.cnt2key[self.least]))
                # å…¨éƒ¨ pop
                self.cnt2key[self.least].pop(tmp)
                self.key2cnt.pop(tmp)
            cnt = 1
            self.key2cnt[key] = [cnt, value]
            self.cnt2key[cnt][key] = None
            self.least = 1  # å› ä¸ºæ˜¯æ–°çš„ key, æ‰€ä»¥æ˜¾ç„¶æœ€å°‘é¢‘æ¬¡å°†æ›´æ–°ä¸º 1
        else:
            self.refresh(key)
            self.key2cnt[key][1] = value

    def LFU(self , operators: List[List[int]], k: int) -> List[int]:
        self.k = k

        ret = []
        for op in operators:
            if op[0] == 1:
                self.set(op[1], op[2])
            else:
                ret.append(self.get(op[1]))

        return ret
```

</details>


<!--START_SECTION:relate-->
---

### ç›¸å…³ä¸»é¢˜

<details><summary><b>è®¾è®¡</b></summary>

> [[ä¸­ç­‰, å‰‘æŒ‡Offer] é˜Ÿåˆ—çš„æœ€å¤§å€¼](../01/å‰‘æŒ‡Offer_5902_ä¸­ç­‰_é˜Ÿåˆ—çš„æœ€å¤§å€¼.md)  
> [[ä¸­ç­‰, ç‰›å®¢] å­—å…¸æ ‘çš„å®ç°](../05/ç‰›å®¢_0124_ä¸­ç­‰_å­—å…¸æ ‘çš„å®ç°.md)  
  > 
> [[å›°éš¾, å‰‘æŒ‡Offer] æ•°æ®æµä¸­çš„ä¸­ä½æ•°](../../2021/12/å‰‘æŒ‡Offer_4100_å›°éš¾_æ•°æ®æµä¸­çš„ä¸­ä½æ•°.md)  
> [[å›°éš¾, ç‰›å®¢] è®¾è®¡LRUç¼“å­˜ç»“æ„ ğŸ”¥](ç‰›å®¢_0093_å›°éš¾_è®¾è®¡LRUç¼“å­˜ç»“æ„.md)  
  > 
> [[ç®€å•, å‰‘æŒ‡Offer] åŒ…å«minå‡½æ•°çš„æ ˆ](../../2021/11/å‰‘æŒ‡Offer_3000_ç®€å•_åŒ…å«minå‡½æ•°çš„æ ˆ.md)  
> [[ç®€å•, å‰‘æŒ‡Offer] ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—](../../2021/11/å‰‘æŒ‡Offer_0900_ç®€å•_ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—.md)  
  > 

</details>
<details><summary><b>ç»å…¸</b></summary>

> [[ä¸­ç­‰, LeetCode] ä¸‹ä¸€ä¸ªæ’åˆ— ğŸ”¥](../10/LeetCode_0031_ä¸­ç­‰_ä¸‹ä¸€ä¸ªæ’åˆ—.md)  
> [[ä¸­ç­‰, LeetCode] äºŒå‰æ ‘çš„å®Œå…¨æ€§æ£€éªŒ ğŸ”¥](../03/LeetCode_0958_ä¸­ç­‰_äºŒå‰æ ‘çš„å®Œå…¨æ€§æ£€éªŒ.md)  
> [[ä¸­ç­‰, LeetCode] æœ€é•¿é€’å¢å­åºåˆ— ğŸ”¥](../06/LeetCode_0300_ä¸­ç­‰_æœ€é•¿é€’å¢å­åºåˆ—.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer2] æ•´æ•°é™¤æ³• ğŸ”¥](../09/å‰‘æŒ‡Offer2_001_ä¸­ç­‰_æ•´æ•°é™¤æ³•.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] ä¸‘æ•° ğŸ”¥](../../2021/12/å‰‘æŒ‡Offer_4900_ä¸­ç­‰_ä¸‘æ•°.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨ ğŸ”¥](../../2021/12/å‰‘æŒ‡Offer_3600_ä¸­ç­‰_äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] åœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—ï¼ˆçº¦ç‘Ÿå¤«ç¯é—®é¢˜ï¼‰ ğŸ”¥](../01/å‰‘æŒ‡Offer_6200_ä¸­ç­‰_åœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—ï¼ˆçº¦ç‘Ÿå¤«ç¯é—®é¢˜ï¼‰.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] å¤æ‚é“¾è¡¨çš„å¤åˆ¶ï¼ˆæ·±æ‹·è´ï¼‰ ğŸ”¥](../../2021/12/å‰‘æŒ‡Offer_3500_ä¸­ç­‰_å¤æ‚é“¾è¡¨çš„å¤åˆ¶ï¼ˆæ·±æ‹·è´ï¼‰.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] å­—ç¬¦ä¸²çš„æ’åˆ—ï¼ˆå…¨æ’åˆ—ï¼‰ ğŸ”¥](../../2021/12/å‰‘æŒ‡Offer_3800_ä¸­ç­‰_å­—ç¬¦ä¸²çš„æ’åˆ—ï¼ˆå…¨æ’åˆ—ï¼‰.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•° ğŸ”¥](../01/å‰‘æŒ‡Offer_6700_ä¸­ç­‰_æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹ï¼ˆå¿«é€Ÿå¹‚ï¼‰ ğŸ”¥](../../2021/11/å‰‘æŒ‡Offer_1600_ä¸­ç­‰_æ•°å€¼çš„æ•´æ•°æ¬¡æ–¹ï¼ˆå¿«é€Ÿå¹‚ï¼‰.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] æ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ— ğŸ”¥](../../2021/11/å‰‘æŒ‡Offer_3100_ä¸­ç­‰_æ ˆçš„å‹å…¥ã€å¼¹å‡ºåºåˆ—.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] é‡å»ºäºŒå‰æ ‘ ğŸ”¥](../../2021/11/å‰‘æŒ‡Offer_0700_ä¸­ç­‰_é‡å»ºäºŒå‰æ ‘.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µï¼ˆ3ç§æ€è·¯4ä¸ªå†™æ³•ï¼‰ ğŸ”¥](../../2021/11/å‰‘æŒ‡Offer_2900_ä¸­ç­‰_é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µï¼ˆ3ç§æ€è·¯4ä¸ªå†™æ³•ï¼‰.md)  
> [[ä¸­ç­‰, ç‰›å®¢] 01èƒŒåŒ… ğŸ”¥](../05/ç‰›å®¢_0145_ä¸­ç­‰_01èƒŒåŒ….md)  
> [[ä¸­ç­‰, ç‰›å®¢] ä¸¢æ£‹å­é—®é¢˜ï¼ˆé¹°è›‹é—®é¢˜ï¼‰ ğŸ”¥](ç‰›å®¢_0087_ä¸­ç­‰_ä¸¢æ£‹å­é—®é¢˜ï¼ˆé¹°è›‹é—®é¢˜ï¼‰.md)  
> [[ä¸­ç­‰, ç‰›å®¢] å­—ç¬¦ä¸²çš„æ’åˆ— ğŸ”¥](../05/ç‰›å®¢_0121_ä¸­ç­‰_å­—ç¬¦ä¸²çš„æ’åˆ—.md)  
> [[ä¸­ç­‰, ç‰›å®¢] å¯»æ‰¾å³°å€¼ ğŸ”¥](ç‰›å®¢_0107_ä¸­ç­‰_å¯»æ‰¾å³°å€¼.md)  
> [[ä¸­ç­‰, ç‰›å®¢] å²›å±¿æ•°é‡ ğŸ”¥](ç‰›å®¢_0109_ä¸­ç­‰_å²›å±¿æ•°é‡.md)  
> [[ä¸­ç­‰, ç‰›å®¢] æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°(atoi) ğŸ”¥](ç‰›å®¢_0100_ä¸­ç­‰_æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°(atoi).md)  
> [[ä¸­ç­‰, ç‰›å®¢] æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­— ğŸ”¥](../03/ç‰›å®¢_0075_ä¸­ç­‰_æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­—.md)  
> [[ä¸­ç­‰, ç‰›å®¢] æœ€é•¿å…¬å…±å­åºåˆ—(äºŒ) ğŸ”¥](ç‰›å®¢_0092_ä¸­ç­‰_æœ€é•¿å…¬å…±å­åºåˆ—(äºŒ).md)  
> [[ä¸­ç­‰, ç‰›å®¢] æ ˆå’Œæ’åº ğŸ”¥](../05/ç‰›å®¢_0115_ä¸­ç­‰_æ ˆå’Œæ’åº.md)  
> [[ä¸­ç­‰, ç‰›å®¢] æ±‰è¯ºå¡”é—®é¢˜ ğŸ”¥](../03/ç‰›å®¢_0067_ä¸­ç­‰_æ±‰è¯ºå¡”é—®é¢˜.md)  
  > 
> [[å›°éš¾, LeetCode] ç¼–è¾‘è·ç¦» ğŸ”¥](../06/LeetCode_0072_å›°éš¾_ç¼–è¾‘è·ç¦».md)  
> [[å›°éš¾, å‰‘æŒ‡Offer] æ•°ç»„ä¸­çš„é€†åºå¯¹ ğŸ”¥](../01/å‰‘æŒ‡Offer_5100_å›°éš¾_æ•°ç»„ä¸­çš„é€†åºå¯¹.md)  
> [[å›°éš¾, ç‰›å®¢] æ¥é›¨æ°´é—®é¢˜ ğŸ”¥](../05/ç‰›å®¢_0128_å›°éš¾_æ¥é›¨æ°´é—®é¢˜.md)  
> [[å›°éš¾, ç‰›å®¢] è®¾è®¡LRUç¼“å­˜ç»“æ„ ğŸ”¥](ç‰›å®¢_0093_å›°éš¾_è®¾è®¡LRUç¼“å­˜ç»“æ„.md)  
  > 
> [[ç®€å•, LeetCode] äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ ğŸ”¥](../07/LeetCode_0104_ç®€å•_äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦.md)  
> [[ç®€å•, LeetCode] åè½¬é“¾è¡¨ ğŸ”¥](../10/LeetCode_0206_ç®€å•_åè½¬é“¾è¡¨.md)  
> [[ç®€å•, å‰‘æŒ‡Offer] äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ ğŸ”¥](../01/å‰‘æŒ‡Offer_6801_ç®€å•_äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ.md)  
> [[ç®€å•, å‰‘æŒ‡Offer] åè½¬é“¾è¡¨ ğŸ”¥](../../2021/11/å‰‘æŒ‡Offer_2400_ç®€å•_åè½¬é“¾è¡¨.md)  
> [[ç®€å•, å‰‘æŒ‡Offer] æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æ•°å­—ï¼ˆæ‘©å°”æŠ•ç¥¨ï¼‰ ğŸ”¥](../../2021/12/å‰‘æŒ‡Offer_3900_ç®€å•_æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€åŠçš„æ•°å­—ï¼ˆæ‘©å°”æŠ•ç¥¨ï¼‰.md)  
> [[ç®€å•, å‰‘æŒ‡Offer] æœ€å°çš„kä¸ªæ•°ï¼ˆpartitionæ“ä½œï¼‰ ğŸ”¥](../../2021/12/å‰‘æŒ‡Offer_4000_ç®€å•_æœ€å°çš„kä¸ªæ•°ï¼ˆpartitionæ“ä½œï¼‰.md)  
> [[ç®€å•, ç‰›å®¢] äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•° ğŸ”¥](../05/ç‰›å®¢_0120_ç®€å•_äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°.md)  
> [[ç®€å•, ç‰›å®¢] å•é“¾è¡¨çš„æ’åº ğŸ”¥](../03/ç‰›å®¢_0070_ç®€å•_å•é“¾è¡¨çš„æ’åº.md)  
> [[ç®€å•, ç‰›å®¢] æ±‚å¹³æ–¹æ ¹ ğŸ”¥](../02/ç‰›å®¢_0032_ç®€å•_æ±‚å¹³æ–¹æ ¹.md)  
  > 

</details>
<!--END_SECTION:relate-->
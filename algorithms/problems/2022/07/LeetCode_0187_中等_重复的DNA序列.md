## é‡å¤çš„DNAåºåˆ—
<!--START_SECTION:badge-->

![last modify](https://img.shields.io/static/v1?label=last%20modify&message=2025-07-08%2016%3A53%3A13&label_color=gray&color=thistle&style=flat-square)
[![](https://img.shields.io/static/v1?label=&message=%E4%B8%AD%E7%AD%89&label_color=gray&color=yellow&style=flat-square)](../../../README.md#ä¸­ç­‰)
[![](https://img.shields.io/static/v1?label=&message=LeetCode&label_color=gray&color=green&style=flat-square)](../../../README.md#leetcode)
[![](https://img.shields.io/static/v1?label=&message=%E5%93%88%E5%B8%8C%E8%A1%A8%28Hash%29&label_color=gray&color=blue&style=flat-square)](../../../README.md#å“ˆå¸Œè¡¨hash)
[![](https://img.shields.io/static/v1?label=&message=%E4%BD%8D%E8%BF%90%E7%AE%97&label_color=gray&color=blue&style=flat-square)](../../../README.md#ä½è¿ç®—)

<!--END_SECTION:badge-->
<!--info
tags: [å“ˆå¸Œè¡¨, ä½è¿ç®—]
source: LeetCode
level: ä¸­ç­‰
number: '0187'
name: é‡å¤çš„DNAåºåˆ—
companies: []
-->

<summary><b>é—®é¢˜ç®€è¿°</b></summary>

```txt
æ‰¾å‡ºç”± ATCG æ„æˆçš„å­—ç¬¦ä¸²ä¸­æ‰€æœ‰é‡å¤ä¸”é•¿åº¦ä¸º 10 çš„å­ä¸²ï¼›
```

<details><summary><b>è¯¦ç»†æè¿°</b></summary>

```txt
æ‰€æœ‰ DNA éƒ½ç”±ä¸€ç³»åˆ—ç¼©å†™ä¸º 'A'ï¼Œ'C'ï¼Œ'G' å’Œ 'T' çš„æ ¸è‹·é…¸ç»„æˆï¼Œä¾‹å¦‚ï¼š"ACGAATTCCG"ã€‚åœ¨ç ”ç©¶ DNA æ—¶ï¼Œè¯†åˆ« DNA ä¸­çš„é‡å¤åºåˆ—æœ‰æ—¶ä¼šå¯¹ç ”ç©¶éå¸¸æœ‰å¸®åŠ©ã€‚

ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æ‰¾å‡ºæ‰€æœ‰ç›®æ ‡å­ä¸²ï¼Œç›®æ ‡å­ä¸²çš„é•¿åº¦ä¸º 10ï¼Œä¸”åœ¨ DNA å­—ç¬¦ä¸² s ä¸­å‡ºç°æ¬¡æ•°è¶…è¿‡ä¸€æ¬¡ã€‚

ç¤ºä¾‹ 1ï¼š
    è¾“å…¥ï¼šs = "AAAAACCCCCAAAAACCCCCCAAAAAGGGTTT"
    è¾“å‡ºï¼š["AAAAACCCCC","CCCCCAAAAA"]
ç¤ºä¾‹ 2ï¼š
    è¾“å…¥ï¼šs = "AAAAAAAAAAAAA"
    è¾“å‡ºï¼š["AAAAAAAAAA"]

æç¤ºï¼š
    0 <= s.length <= 10^5
    s[i] ä¸º 'A'ã€'C'ã€'G' æˆ– 'T'

æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/repeated-dna-sequences
è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
```

</details>

<summary><b>æ€è·¯</b></summary>

- åŸºæœ¬æ€è·¯ï¼šå“ˆå¸Œè¡¨è®¡æ•°ï¼›
- å¦‚æœç›´æ¥ä½¿ç”¨å­ä¸²æœ¬èº«ä½œä¸ºå“ˆå¸Œè¡¨çš„ keyï¼Œé‚£ä¹ˆæ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½æ˜¯ `O(NL)`ï¼›è€Œå¦‚æœä½¿ç”¨ä½è¿ç®—+æ»‘åŠ¨çª—å£æ‰‹åŠ¨æ„é€  keyï¼Œå¯ä»¥æŠŠå¤æ‚åº¦é™ä¸º `O(N)`ï¼›


<details><summary><b>å­ä¸²ä½œä¸º key</b></summary>

- æ—¶é—´&ç©ºé—´å¤æ‚åº¦ï¼š`O(NL)`ï¼›
```python
class Solution:
    def findRepeatedDnaSequences(self, s: str) -> List[str]:
        """"""
        # from collections import defaultdict
        L = 10

        cnt = defaultdict(int)
        ans = []
        for i in range(len(s) - L + 1):
            subs = s[i: i+L]
            cnt[subs] += 1
            if cnt[subs] == 2:
                ans.append(subs)

        return ans
```

</details>

<details><summary><b>ä½è¿ç®—+æ»‘åŠ¨çª—å£</b></summary>

- æ—¶é—´&ç©ºé—´å¤æ‚åº¦ï¼š`O(N)`ï¼›
```python
class Solution:
    def findRepeatedDnaSequences(self, s: str) -> List[str]:
        """"""
        # from collections import defaultdict
        L = 10
        B = {'A': 0, 'T': 1, 'C': 2, 'G': 3}  # åˆ†åˆ«ä¸º 00, 01, 10, 11

        if len(s) < L + 1:  # assertï¼Œå¦åˆ™éƒ¨åˆ†ç”¨ä¾‹ä¼šæ— æ³•é€šè¿‡
            return []

        # å…ˆè®¡ç®—å‰ 9 ä½çš„å€¼
        x = 0
        for i in range(L - 1):
            b = B[s[i]]
            x = (x << 2) | b

        ans = []
        cnt = defaultdict(int)
        for i in range(len(s) - L + 1):
            b = B[s[i + L - 1]]
            # æ³¨æ„è¯¥æœ‰çš„æ‹¬å·ä¸è¦å°‘ï¼Œé¿å…è¿ç®—ä¼˜å…ˆçº§æ··ä¹±
            x = ((x << 2) | b) & ((1 << (L * 2)) - 1)  # æ»‘åŠ¨è®¡ç®—å­ä¸²çš„ hash å€¼
            cnt[x] += 1
            if cnt[x] == 2:
                ans.append(s[i: i + L])

        return ans
```

</details>


<details><summary><b>ä½è¿ç®—è¯´æ˜</b></summary>

- `(x << 2) | b`ï¼š
    ```python
    # ä»¥ä¸ºå‡ä¸ºäºŒè¿›åˆ¶è¡¨ç¤º
    è®¾ x = 0010 1011, b = 10: 
    è¯¥è¿ç®—ç›¸å½“äºæŠŠ b â€œæ‹¼â€ åˆ° x æœ«å°¾

    x         :   0010 1011
    x = x << 2:   1010 1100
    
    x = x | b :   1010 1100
                | 0000 0010
                -----------
                  1010 1110
    ```
- `x & ((1 << (L * 2)) - 1)`
    ```python
    # è¯¥è¿ç®—æŠŠ x é™¤ä½ 10 ä½å‰çš„æ‰€æœ‰ä½ç½®ç½® 0
    è®¾ L = 5ï¼Œx = 1110 1010 1010: 
    
    y = 1 << (L * 2):   0100 0000 0000
    y = y - 1       :   0011 1111 1111

    x = x & y       :   1110 1010 1010
                      & 0011 1111 1111
                      ----------------
                        0010 1010 1010

    ```

</details>


<!--START_SECTION:relate-->

---

### ç›¸å…³ä¸»é¢˜

<details><summary><b>å“ˆå¸Œè¡¨(Hash)</b></summary>

> [[ä¸­ç­‰, LeetCode] å­—æ¯å¼‚ä½è¯åˆ†ç»„ ğŸ”¥](../10/LeetCode_0049_ä¸­ç­‰_å­—æ¯å¼‚ä½è¯åˆ†ç»„.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] å¤æ‚é“¾è¡¨çš„å¤åˆ¶ï¼ˆæ·±æ‹·è´ï¼‰ ğŸ”¥](../../2021/12/å‰‘æŒ‡Offer_3500_ä¸­ç­‰_å¤æ‚é“¾è¡¨çš„å¤åˆ¶ï¼ˆæ·±æ‹·è´ï¼‰.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²](../../2021/12/å‰‘æŒ‡Offer_4800_ä¸­ç­‰_æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸².md)  
> [[ä¸­ç­‰, ç‰›å®¢] å’Œä¸ºKçš„è¿ç»­å­æ•°ç»„](../05/ç‰›å®¢_0125_ä¸­ç­‰_å’Œä¸ºKçš„è¿ç»­å­æ•°ç»„.md)  
  > 
> [[å›°éš¾, ç‰›å®¢] æ•°ç»„ä¸­çš„æœ€é•¿è¿ç»­å­åºåˆ—](../04/ç‰›å®¢_0095_å›°éš¾_æ•°ç»„ä¸­çš„æœ€é•¿è¿ç»­å­åºåˆ—.md)  
  > 
> [[ç®€å•, LeetCode] ä¸¤æ•°ä¹‹å’Œ ğŸ”¥](../../2021/10/LeetCode_0001_ç®€å•_ä¸¤æ•°ä¹‹å’Œ.md)  
> [[ç®€å•, å‰‘æŒ‡Offer] æ•°ç»„ä¸­é‡å¤çš„æ•°å­—](../../2021/11/å‰‘æŒ‡Offer_0300_ç®€å•_æ•°ç»„ä¸­é‡å¤çš„æ•°å­—.md)  
> [[ç®€å•, å‰‘æŒ‡Offer] ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦](../../2021/12/å‰‘æŒ‡Offer_5000_ç®€å•_ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦.md)  
> [[ç®€å•, ç‰›å®¢] ä¸¤æ•°ä¹‹å’Œ](../03/ç‰›å®¢_0061_ç®€å•_ä¸¤æ•°ä¹‹å’Œ.md)  
> [[ç®€å•, ç‰›å®¢] ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦](../02/ç‰›å®¢_0031_ç®€å•_ç¬¬ä¸€ä¸ªåªå‡ºç°ä¸€æ¬¡çš„å­—ç¬¦.md)  
> [[ç®€å•, ç¨‹åºå‘˜é¢è¯•é‡‘å…¸] åˆ¤å®šæ˜¯å¦äº’ä¸ºå­—ç¬¦é‡æ’](../09/ç¨‹åºå‘˜é¢è¯•é‡‘å…¸_0102_ç®€å•_åˆ¤å®šæ˜¯å¦äº’ä¸ºå­—ç¬¦é‡æ’.md)  
  > 

</details>
<details><summary><b>ä½è¿ç®—</b></summary>

> [[ä¸­ç­‰, LeetCode] ä¸¤æ•°ç›¸é™¤](../../2021/10/LeetCode_0029_ä¸­ç­‰_ä¸¤æ•°ç›¸é™¤.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°](../01/å‰‘æŒ‡Offer_5601_ä¸­ç­‰_æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°.md)  
> [[ä¸­ç­‰, å‰‘æŒ‡Offer] æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°](../01/å‰‘æŒ‡Offer_5602_ä¸­ç­‰_æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°.md)  
> [[ä¸­ç­‰, ç‰›å®¢] æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­— ğŸ”¥](../03/ç‰›å®¢_0075_ä¸­ç­‰_æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­—.md)  
  > 
> [[å›°éš¾, ç‰›å®¢] Nçš‡åé—®é¢˜](../03/ç‰›å®¢_0039_å›°éš¾_Nçš‡åé—®é¢˜.md)  
  > 
> [[ç®€å•, å‰‘æŒ‡Offer] ä¸ç”¨åŠ å‡ä¹˜é™¤åšåŠ æ³•](../01/å‰‘æŒ‡Offer_6500_ç®€å•_ä¸ç”¨åŠ å‡ä¹˜é™¤åšåŠ æ³•.md)  
> [[ç®€å•, å‰‘æŒ‡Offer] äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°](../../2021/11/å‰‘æŒ‡Offer_1500_ç®€å•_äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°.md)  
> [[ç®€å•, ç‰›å®¢] äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•° ğŸ”¥](../05/ç‰›å®¢_0120_ç®€å•_äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°.md)  
  > 

</details>

<!--END_SECTION:relate-->